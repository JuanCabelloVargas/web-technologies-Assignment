<div class="container mt-3">
  <h1 class="mb-3 text-primary">Challenge Requests</h1>

  <% if @incoming_requests.any? %>
    <div class="mb-4">
      <h4>Requests for your challenges</h4>
      <ul class="list-group">
        <% @incoming_requests.each do |request| %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <div><strong>User:</strong> <%= request.requester.username %></div>
              <div><strong>Challenge:</strong> <%= request.challenge.name %></div>
              <div><strong>Status:</strong> <%= request.status.capitalize %></div>
              <% if request.message.present? %>
                <div class="small text-muted">“<%= request.message %>”</div>
              <% end %>
            </div>
            <div class="d-flex gap-2">
              <% if request.status == "pending" %>
                <%= button_to "Approve",
                              approve_challenge_request_path(request),
                              method: :patch,
                              class: "btn btn-success btn-sm" %>
                <%= button_to "Reject",
                              reject_challenge_request_path(request),
                              method: :patch,
                              class: "btn btn-danger btn-sm" %>
              <% end %>
              <%= link_to "View", challenge_request_path(request), class: "btn btn-outline-secondary btn-sm" %>
            </div>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <h4>Your requests</h4>
    <% if @outgoing_requests.any? %>
      <ul class="list-group">
        <% @outgoing_requests.each do |request| %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <div><strong>Challenge:</strong> <%= request.challenge.name %></div>
              <div><strong>Status:</strong> <%= request.status.capitalize %></div>
              <% if request.message.present? %>
                <div class="small text-muted">“<%= request.message %>”</div>
              <% end %>
            </div>
            <%= link_to "View", challenge_request_path(request), class: "btn btn-outline-secondary btn-sm" %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted">You have not sent any requests.</p>
    <% end %>
  </div>
</div>
